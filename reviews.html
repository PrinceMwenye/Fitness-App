<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Fitness 4 ALL</title>
    <meta name="comp1800 boilerplate code" content="my bcit project">
    <meta name="author" content="BCIT">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="../styles/location.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Google Icons (Material Design)-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <!-- Bootstrap & Firebase CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.css" />

    <!-- Bootstrap & Firebase Javascript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>

    <!-- Google Icons (Material Design)-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Firebase 8 CDN's -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous">
    </script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>

    <!-- Link to the api keys for your firebase project -->
    <script src="../scripts/firebaseAPI.js"></script>
</head>

<body>
    <header style="margin-bottom: 80px;">
        <nav class="navbar navbar-dark bg-dark fixed-top ">
            <div class="container-fluid">
                <a class="navbar-brand" href="index.html">Fitness4all</a>
                <i class="material-icons" style="color: white;">fitness_center</i>
                <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
            <span class="navbar-toggler-icon"></span>
        </button>
                <div class="offcanvas offcanvas-end bg-dark" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
                    <div class="offcanvas-header">
                        <h5 class="offcanvas-title text-white" id="offcanvasNavbarLabel">Offcanvas</h5>
                        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body">
                        <form class="d-flex">
                            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                            <button class="btn btn-outline-success" type="submit">Search</button>
                        </form>
                        <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                            <li class="nav-item">
                                <a class="nav-link" href="#">My account</a>
                            </li>
                            -aria-current="page", class="nav-link active"-
                            <li class="nav-item">
                                <a class="nav-link" href="main.html">My work-out</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="motivational_content/motivational_type_selection.html">My motivation</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">My settings</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="location.html">Explore locations</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </header>


    <h1>Thanks for your review ðŸ˜€<span id="WorkoutName"></span></h1>

    <form>
        <div class="form-group">
            <label for="exampleFormControlInput1">Workout review</label>
            <input type="text" class="form-control" id="title" placeholder="Title">
        </div><br>
        <div class="form-group">
            <label for="exampleFormControlSelect1">Recommend this workout?</label>
            <select class="form-control" id="recommend">
                <option>Yes</option>
                <option>No</option>
            </select>
            <br>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Which target muscle are you focusing on?</label>
                <select class="form-control" id="target">
                    <option>Lower body</option>
                    <option>Upper Body</option>
                   
                </select>
                <br>
            </div>
            <div class="form-group">
                <label for="exampleFormControlTextarea1">Any other comments?</label>
                <textarea class="form-control" id="description" rows="3"></textarea>
            </div>

            <br>
            <div class="d-flex justify-content-end">
                <a href="Review_success.html"><button type="button" class="btn btn-lg btn-primary pull-right" onclick="writeReview()">Submit</button></a>
            </div>
        </div>
    </form>

    <script>
        let WorkoutID = localStorage.getItem("WorkoutID");

        db.collection("Workouts").where("code", "==", WorkoutID)
            .get()
            .then(queryWorkout => {
                //see how many results you have got from the query
                num = queryWorkout.size;
                // get the documents of query
                Workouts = queryWorkout.docs;

                // We want to have one document per hike, so if the the result of 
                //the query is more than one, we can check it right now and clean the DB if needed.
                if (num = 1) {
                    var thisWorkout = Workouts[0].data();
                    name = thisWorkout.name;
                    document.getElementById("WorkoutName").innerHTML = name;
                } else {}
            })
            .catch((error) => {
                console.log("Error getting documents: ", error);
            });





        function writeReview() {


            let Title = document.getElementById("title").value;
            let Recommend = document.getElementById("recommend").value;
            let Target = document.getElementById("target").value;



            firebase.auth().onAuthStateChanged(user => {
                if (user) {
                    var currentUser = db.collection("users").doc(user.uid);
                    var userID = user.uid;
                    //get the document for current user.
                    currentUser.get()
                        .then(userDoc => {
                            //get user Email
                            var userEmail = userDoc.data().email;
                            // Start a new collection and add all data in it.
                            db.collection("Reviews").add({
                                code: WorkoutID,
                                UserID: userID,
                                UserEmail: userEmail,
                                Title: Title,
                                Target: Target,
                                Recommend: Recommend

                            });
                        })
                } else {
                    // No user is signed in.
                    console.log("no user signed in");
                }
            });


        }
    </script>